!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.cql=e()}}(function(){var e;return function n(e,t,r){function i(u,a){if(!t[u]){if(!e[u]){var c="function"==typeof require&&require;if(!a&&c)return c(u,!0);if(o)return o(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var f=t[u]={exports:{}};e[u][0].call(f.exports,function(n){var t=e[u][1][n];return i(t?t:n)},f,f.exports,n,e,t,r)}return t[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(e,n,t){},{}],2:[function(e,n,t){"use strict";var r=function(){function e(e){this.constraint=e}return e.prototype.name=function(){return this.constraint.name},e.prototype.description=function(){return this.constraint.description},e.prototype.properties=function(){return this.constraint.properties},e.prototype.strict=function(){return this.constraint.strict},e}();t.AbstractConstraintModel=r},{}],3:[function(e,n,t){"use strict";var r=this&&this.__extends||function(e,n){function t(){this.constructor=e}for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)},i=e("vega-lite/src/channel"),o=e("vega-lite/src/type"),u=e("../property"),a=e("../query"),c=e("../schema"),s=e("../util"),f=e("./base"),l=function(e){function n(n){e.call(this,n)}return r(n,e),n.prototype.satisfy=function(e,n,t,r){if(this.constraint.requireAllProperties){var i=s.some(this.constraint.properties,function(n){return a.isEnumSpec(e[n])});if(i)return!0}return this.constraint.satisfy(e,n,t,r)},n}(f.AbstractConstraintModel);t.EncodingConstraintModel=l,t.ENCODING_CONSTRAINTS=[{name:"aggregateOpSupportedByType",description:"Aggregate function should be supported by data type.",properties:[u.Property.TYPE,u.Property.AGGREGATE],requireAllProperties:!0,strict:!0,satisfy:function(e,n,t,r){return e.aggregate?e.type!==o.Type.ORDINAL&&e.type!==o.Type.NOMINAL:!0}},{name:"binAppliedForQuantitative",description:"bin should be applied to quantitative field only.",properties:[u.Property.TYPE,u.Property.BIN],requireAllProperties:!0,strict:!0,satisfy:function(e,n,t,r){return e.bin?e.type===o.Type.QUANTITATIVE:!0}},{name:"channelSupportsRole",description:"encoding channel should support the role of the field",properties:[u.Property.CHANNEL,u.Property.TYPE,u.Property.BIN,u.Property.TIMEUNIT],requireAllProperties:!1,strict:!0,satisfy:function(e,n,t){if(a.isEnumSpec(e.channel))return!0;var r=i.getSupportedRole(e.channel);return a.isDimension(e)?r.dimension:a.isMeasure(e)?r.measure:!0}},{name:"onlyOneTypeOfFunction",description:"Only of of aggregate, autoCount, timeUnit, or bin should be applied at the same time.",properties:[u.Property.AGGREGATE,u.Property.AUTOCOUNT,u.Property.TIMEUNIT,u.Property.BIN],requireAllProperties:!1,strict:!0,satisfy:function(e,n,t,r){var i=(!a.isEnumSpec(e.aggregate)&&e.aggregate?1:0)+(!a.isEnumSpec(e.autoCount)&&e.autoCount?1:0)+(!a.isEnumSpec(e.bin)&&e.bin?1:0)+(!a.isEnumSpec(e.timeUnit)&&e.timeUnit?1:0);return 1>=i}},{name:"timeUnitAppliedForTemporal",description:"Time unit should be applied to temporal field only.",properties:[u.Property.TYPE,u.Property.TIMEUNIT],requireAllProperties:!0,strict:!0,satisfy:function(e,n,t,r){return!e.timeUnit||e.type===o.Type.TEMPORAL}},{name:"typeMatchesPrimitiveType",description:"Data type should be supported by field's primitive type.",properties:[u.Property.FIELD,u.Property.TYPE],requireAllProperties:!0,strict:!0,satisfy:function(e,n,t,r){var i=n.primitiveType(e.field),u=e.type;switch(i){case c.PrimitiveType.BOOLEAN:case c.PrimitiveType.STRING:return u!==o.Type.QUANTITATIVE&&u!==o.Type.TEMPORAL;case c.PrimitiveType.NUMBER:case c.PrimitiveType.INTEGER:return u!==o.Type.TEMPORAL;case c.PrimitiveType.DATE:return u===o.Type.TEMPORAL;case null:return!1}throw new Error("Not implemented")}},{name:"typeMatchesSchemaType",description:"Enumerated data type of a field should match the field's type in the schema.",properties:[u.Property.FIELD,u.Property.TYPE],requireAllProperties:!0,strict:!1,satisfy:function(e,n,t,r){return n.type(e.field)===e.type}},{name:"maxCardinalityForCategoricalColor",description:"Categorical channel should not have too high cardinality",properties:[u.Property.CHANNEL,u.Property.FIELD],requireAllProperties:!0,strict:!1,satisfy:function(e,n,t,r){return e.channel===i.Channel.COLOR&&e.type===o.Type.NOMINAL?t.cardinality(e)<=r.maxCardinalityForCategoricalColor:!0}},{name:"maxCardinalityForFacet",description:"Row/column channel should not have too high cardinality",properties:[u.Property.CHANNEL,u.Property.FIELD,u.Property.BIN,u.Property.TIMEUNIT],requireAllProperties:!0,strict:!1,satisfy:function(e,n,t,r){return e.channel===i.Channel.ROW||e.channel===i.Channel.COLUMN?t.cardinality(e)<=r.maxCardinalityForFacet:!0}},{name:"maxCardinalityForShape",description:"Shape channel should not have too high cardinality",properties:[u.Property.CHANNEL,u.Property.FIELD,u.Property.BIN,u.Property.TIMEUNIT],requireAllProperties:!0,strict:!1,satisfy:function(e,n,t,r){return e.channel===i.Channel.SHAPE?t.cardinality(e)<=r.maxCardinalityForShape:!0}}].map(function(e){return new l(e)}),t.ENCODING_CONSTRAINT_INDEX=t.ENCODING_CONSTRAINTS.reduce(function(e,n){return e[n.name()]=n,e},{}),t.ENCODING_CONSTRAINTS_BY_PROPERTY=t.ENCODING_CONSTRAINTS.reduce(function(e,n){return n.properties().forEach(function(t){e[t]=e[t]||[],e[t].push(n)}),e},{})},{"../property":9,"../query":10,"../schema":11,"../util":13,"./base":2,"vega-lite/src/channel":25,"vega-lite/src/type":29}],4:[function(e,n,t){"use strict";function r(e,n){return function(t,r,i,u){var a=t.getEncodingQueryByChannel(o.Channel.X),c=t.getEncodingQueryByChannel(o.Channel.Y),s=a&&a.type===e,f=c&&c.type===e;return!c||!a||s&&f||!s&&!f||s&&u[n]===o.Channel.X||f&&u[n]===o.Channel.Y}}var i=this&&this.__extends||function(e,n){function t(){this.constructor=e}for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)},o=e("vega-lite/src/channel"),u=e("vega-lite/src/mark"),a=e("vega-lite/src/type"),c=e("./base"),s=e("../property"),f=e("../query"),l=e("../util"),p=function(e){function n(n){e.call(this,n)}return i(n,e),n.prototype.satisfy=function(e,n,t,r){if(this.constraint.requireAllProperties){var i=l.some(this.constraint.properties,function(n){switch(n){case s.Property.MARK:return f.isEnumSpec(e.getMark());case s.Property.CHANNEL:case s.Property.AGGREGATE:case s.Property.BIN:case s.Property.TIMEUNIT:case s.Property.FIELD:case s.Property.TYPE:return l.some(e.getEncodings(),function(e){return f.isEnumSpec(e[n])});default:throw new Error("Unimplemnted")}});if(i)return!0}return this.constraint.satisfy(e,n,t,r)},n}(c.AbstractConstraintModel);t.SpecConstraintModel=p,t.SPEC_CONSTRAINTS=[{name:"autoAddCount",description:"Automatically adding count only for plots with only ordinal, binned quantitative, or temporal with timeunti fields.",properties:[s.Property.BIN,s.Property.TIMEUNIT,s.Property.TYPE,s.Property.AUTOCOUNT],requireAllProperties:!1,strict:!1,satisfy:function(e,n,t,r){var i=l.some(e.getEncodings(),function(e){return e.autoCount===!0});if(i)return l.every(e.getEncodings(),function(e){if(void 0!==e.autoCount)return!0;switch(e.type){case a.Type.QUANTITATIVE:return!!e.bin;case a.Type.TEMPORAL:return!!e.timeUnit;case a.Type.ORDINAL:case a.Type.NOMINAL:return!0}throw new Error("Unsupported Type")});var o=l.every(e.enumSpecIndex.autoCount,function(n){return!f.isEnumSpec(e.getEncodingQueryByIndex(n.index).autoCount)});return o?l.some(e.getEncodings(),function(e){return e.type===a.Type.QUANTITATIVE?e.autoCount===!1?!1:!e.bin||f.isEnumSpec(e.bin):e.type===a.Type.TEMPORAL?!e.timeUnit||f.isEnumSpec(e.timeUnit):!1}):!0}},{name:"channelPermittedByMarkType",description:"Each encoding channel should be supported by the mark type",properties:[s.Property.CHANNEL,s.Property.MARK],requireAllProperties:!1,strict:!0,satisfy:function(e,n,t,r){var i=e.getMark();return f.isEnumSpec(i)?!0:l.every(e.getEncodings(),function(e){return f.isEnumSpec(e.channel)?!0:o.supportMark(e.channel,i)})}},{name:"hasAllRequiredChannelsForMark",description:"All required channels for the specified mark should be specified",properties:[s.Property.CHANNEL,s.Property.MARK],requireAllProperties:!0,strict:!0,satisfy:function(e,n,t,r){var i=e.getMark();switch(i){case u.Mark.AREA:case u.Mark.LINE:return e.channelUsed(o.Channel.X)&&e.channelUsed(o.Channel.Y);case u.Mark.TEXT:return e.channelUsed(o.Channel.TEXT);case u.Mark.BAR:case u.Mark.CIRCLE:case u.Mark.POINT:case u.Mark.SQUARE:case u.Mark.TICK:return!0;case u.Mark.RULE:return e.channelUsed(o.Channel.X)||e.channelUsed(o.Channel.Y)}throw new Error("hasAllRequiredChannelsForMark not implemented for mark"+i)}},{name:"omitFacetOverPositionalChannels",description:"Do not use non-positional channels unless all positional channels are used",properties:[s.Property.CHANNEL],requireAllProperties:!0,strict:!1,satisfy:function(e,n,t,r){return e.channelUsed(o.Channel.ROW)||e.channelUsed(o.Channel.COLUMN)?e.channelUsed(o.Channel.X)&&e.channelUsed(o.Channel.Y):!0}},{name:"omitMultipleNonPositionalChannels",description:"Do not use multiple non-positional encoding channel to avoid over-encoding.",properties:[s.Property.CHANNEL],requireAllProperties:!1,strict:!1,satisfy:function(e,n,t,r){for(var i=e.getEncodings(),u=0,a=0;a<i.length;a++){var c=i[a].channel;if(!f.isEnumSpec(c)&&(c===o.Channel.COLOR||c===o.Channel.SHAPE||c===o.Channel.SIZE)&&(u+=1,u>1))return!1}return!0}},{name:"omitNonPositionalOverPositionalChannels",description:"Do not use non-positional channels unless all positional channels are used",properties:[s.Property.CHANNEL],requireAllProperties:!0,strict:!1,satisfy:function(e,n,t,r){return l.some(o.NONSPATIAL_CHANNELS,function(n){return e.channelUsed(n)})?e.channelUsed(o.Channel.X)&&e.channelUsed(o.Channel.Y):!0}},{name:"omitRawBarLineArea",description:"Don't use bar, line or area to visualize raw plot as they often lead to occlusion.",properties:[s.Property.MARK,s.Property.AGGREGATE],requireAllProperties:!0,strict:!1,satisfy:function(e,n,t,r){return l.isin(e.getMark(),[u.Mark.BAR,u.Mark.LINE,u.Mark.AREA])?e.isAggregate():!0}},{name:"omitRawContinuousFieldForAggregatePlot",description:"Aggregate plot should not use raw continuous field as group by values. (Quantitative should be binned. Temporal should have time unit.)",properties:[s.Property.AGGREGATE,s.Property.TIMEUNIT,s.Property.BIN,s.Property.TYPE],requireAllProperties:!1,strict:!1,satisfy:function(e,n,t,r){return e.isAggregate()?l.every(e.getEncodings(),function(e){return e.type===a.Type.TEMPORAL?!!e.timeUnit:e.type===a.Type.QUANTITATIVE?!!e.bin||!!e.aggregate:!0}):!0}},{name:"omitRepeatedField",description:"Each field should be mapped to only one channel",properties:[s.Property.FIELD],requireAllProperties:!1,strict:!1,satisfy:function(e,n,t,r){var i={};return l.every(e.getEncodings(),function(e){return e.field&&!f.isEnumSpec(e.field)?i[e.field]?!1:(i[e.field]=!0,!0):!0})}},{name:"omitVerticalDotPlot",description:"Do not output vertical dot plot.",properties:[s.Property.CHANNEL],requireAllProperties:!1,strict:!1,satisfy:function(e,n,t,r){var i=e.getEncodings();return 1!==i.length||i[0].channel!==o.Channel.Y}},{name:"preferredBinAxis",description:"Always use preferred axis for a binned field.",properties:[s.Property.CHANNEL,s.Property.BIN],requireAllProperties:!0,strict:!1,satisfy:function(e,n,t,r){var i=e.getEncodingQueryByChannel(o.Channel.X),u=e.getEncodingQueryByChannel(o.Channel.Y),a=i&&!!i.bin,c=u&&!!u.bin;return a&&c||!a&&!c||a&&r.preferredBinAxis===o.Channel.X||c&&r.preferredBinAxis===o.Channel.Y}},{name:"preferredTemporalAxis",description:"Always use preferred axis for a time field.",properties:[s.Property.CHANNEL,s.Property.TYPE],requireAllProperties:!0,strict:!1,satisfy:r(a.Type.TEMPORAL,"preferredTemporalAxis")},{name:"preferredOrdinalAxis",description:"Always use preferred axis for an ordinal field.",properties:[s.Property.CHANNEL,s.Property.TYPE],requireAllProperties:!0,strict:!1,satisfy:r(a.Type.ORDINAL,"preferredOrdinalAxis")},{name:"preferredNominalAxis",description:"Always use preferred axis for a nominal field.",properties:[s.Property.CHANNEL,s.Property.TYPE],requireAllProperties:!0,strict:!1,satisfy:r(a.Type.NOMINAL,"preferredNominalAxis")},{name:"noRepeatedChannel",description:"Each encoding channel should only be used once.",properties:[s.Property.CHANNEL],requireAllProperties:!1,strict:!0,satisfy:function(e,n,t,r){var i={};return l.every(e.getEncodings(),function(e){return f.isEnumSpec(e.channel)?!0:i[e.channel]?!1:(i[e.channel]=!0,!0)})}}].map(function(e){return new p(e)}),t.SPEC_CONSTRAINT_INDEX=t.SPEC_CONSTRAINTS.reduce(function(e,n){return e[n.name()]=n,e},{}),t.SPEC_CONSTRAINTS_BY_PROPERTY=t.SPEC_CONSTRAINTS.reduce(function(e,n){return n.properties().forEach(function(t){e[t]=e[t]||[],e[t].push(n)}),e},{})},{"../property":9,"../query":10,"../util":13,"./base":2,"vega-lite/src/channel":25,"vega-lite/src/mark":27,"vega-lite/src/type":29}],5:[function(e,n,t){"use strict";t.version="0.0.1";var r=e("./generate"),i=e("./group"),o=e("./model"),u=e("./property"),a=e("./query"),c=e("./schema"),s=e("./stats"),f=e("./util");t.generate=r.generate,t.group=i,t.model=o,t.property=u,t.query=a,t.schema=c,t.stats=s,t.util=f},{"./generate":6,"./group":7,"./model":8,"./property":9,"./query":10,"./schema":11,"./stats":12,"./util":13}],6:[function(e,n,t){"use strict";function r(e,n,r,i){void 0===i&&(i={}),i=f.extend({},s.DEFAULT_QUERY_CONFIG,i);var o=a.SpecQueryModel.build(e,n,i),u=o.enumSpecIndex,c=[o];return i.propertyPrecedence.forEach(function(e){if(u[e]){var o=t.ENUMERATOR_INDEX[e](u,n,r,i);c=c.reduce(o,[])}}),c}function i(e){return function(n,t,r,i){return function(a,c){function s(n){if(n===l.length)return void a.push(c.duplicate());var p=l[n],d=c.getEncodingQueryByIndex(p.index);if(d.autoCount===!1)s(n+1);else{var y=c.getEncodingProperty(p.index,e);y.enumValues.forEach(function(a){c.setEncodingProperty(p.index,e,a,p.enumSpec);var l=o.ENCODING_CONSTRAINTS_BY_PROPERTY[e]||[],d=f.every(l,function(e){if(e.strict()||i[e.name()]){var n=e.satisfy(c.getEncodingQueryByIndex(p.index),t,r,i);return!n&&i.verbose&&console.log(e.name()+" failed with "+c.toShorthand()+" for "+p.enumSpec.name),n}return!0});if(d){var y=u.SPEC_CONSTRAINTS_BY_PROPERTY[e]||[],h=f.every(y,function(e){if(e.strict()||i[e.name()]){var n=e.satisfy(c,t,r,i);return!n&&i.verbose&&console.log(e.name()+" failed with "+c.toShorthand()+" for "+p.enumSpec.name),n}return!0});h&&s(n+1)}}),c.resetEncodingProperty(p.index,e,p.enumSpec)}}var l=n[e];return s(0),a}}}var o=e("./constraint/encoding"),u=e("./constraint/spec"),a=e("./model"),c=e("./property"),s=e("./query"),f=e("./util");t.ENUMERATOR_INDEX={},t.generate=r,t.ENUMERATOR_INDEX[c.Property.MARK]=function(e,n,t,r){return function(e,i){var o=i.getMark();return o.enumValues.forEach(function(o){i.setMark(o);var a=u.SPEC_CONSTRAINTS_BY_PROPERTY[c.Property.MARK]||[],s=f.every(a,function(e){if(e.strict()||r[e.name()]){var o=e.satisfy(i,n,t,r);return!o&&r.verbose&&console.log(e.name()+" failed with "+i.toShorthand()+" for mark"),o}return!0});s&&e.push(i.duplicate())}),i.resetMark(),e}},c.ENCODING_PROPERTIES.forEach(function(e){t.ENUMERATOR_INDEX[e]=i(e)}),t.EncodingPropertyGeneratorFactory=i},{"./constraint/encoding":3,"./constraint/spec":4,"./model":8,"./property":9,"./query":10,"./util":13}],7:[function(e,n,t){"use strict";function r(e,n){return e.reduce(function(e,t){var r=n(t);return e[r]=e[r]||[],e[r].push(t),e},{})}function i(e){return e.getEncodings().map(c.stringifyEncodingQueryFieldDef).sort().join("|")}function o(e){if(c.isEnumSpec(e))return c.SHORT_ENUM_SPEC+"";var n=e;switch(n){case a.Channel.X:case a.Channel.Y:return"xy";case a.Channel.ROW:case a.Channel.COLUMN:return"facet";case a.Channel.COLOR:case a.Channel.SIZE:case a.Channel.SHAPE:case a.Channel.OPACITY:return"non-xy";case a.Channel.TEXT:case a.Channel.DETAIL:case a.Channel.PATH:case a.Channel.ORDER:return n+""}return console.warn("channel type not implemented for "+n),n+""}function u(e){return e.getEncodings().map(function(e){var n=c.stringifyEncodingQueryFieldDef(e);return o(e.channel)+":"+n}).sort().join("|")}var a=e("vega-lite/src/channel"),c=e("./query");t.group=r,t.dataKey=i,t.encodingKey=u},{"./query":10,"vega-lite/src/channel":25}],8:[function(e,n,t){"use strict";function r(e){switch(e){case a.Property.MARK:return"m";case a.Property.CHANNEL:return"c";case a.Property.AGGREGATE:return"a";case a.Property.AUTOCOUNT:return"#";case a.Property.BIN:return"b";case a.Property.TIMEUNIT:return"tu";case a.Property.FIELD:return"f";case a.Property.TYPE:return"t"}throw new Error("Default name undefined")}function i(e,n,t){switch(e){case a.Property.FIELD:return n.fields();case a.Property.BIN:case a.Property.AUTOCOUNT:return[!1,!0];case a.Property.MARK:case a.Property.CHANNEL:case a.Property.AGGREGATE:case a.Property.TIMEUNIT:case a.Property.TYPE:return t[e+"s"]||[]}throw new Error("No default enumValues for "+e)}var o=e("vega-lite/src/aggregate"),u=e("vega-lite/src/type"),a=e("./property"),c=e("./query"),s=e("./util");t.getDefaultEnumValues=i;var f=function(){function e(e,n,t,r){void 0===r&&(r={}),this._spec=e,this._encodingMap=e.encodings.reduce(function(e,n){return c.isEnumSpec(n.channel)||(e[n.channel]=n),e},{}),this._enumSpecIndex=n,this._enumSpecAssignment=r,this._schema=t}return e.build=function(n,t,o){n=s.duplicate(n);var f={};if(c.isEnumSpec(n.mark)){var l=r(a.Property.MARK);n.mark=c.initEnumSpec(n.mark,l,o.marks),f.mark={enumSpec:n.mark}}if(n.encodings.forEach(function(e,n){void 0!==e.autoCount&&(console.warn("A field with autoCount should not be included as autoCount meant to be an internal object."),e.type=u.Type.QUANTITATIVE),void 0===e.type&&(e.type=c.SHORT_ENUM_SPEC),a.ENCODING_PROPERTIES.forEach(function(u){if(c.isEnumSpec(e[u])){var a=r(u)+n,s=i(u,t,o);e[u]=c.initEnumSpec(e[u],a,s),(f[u]=f[u]||[]).push({enumSpec:e[u],index:n})}})}),o.autoAddCount){var p={channel:{name:r(a.Property.CHANNEL)+n.encodings.length,enumValues:i(a.Property.CHANNEL,t,o)},autoCount:{name:r(a.Property.AUTOCOUNT)+n.encodings.length,enumValues:[!1,!0]},type:u.Type.QUANTITATIVE};n.encodings.push(p);var d=n.encodings.length-1;[a.Property.CHANNEL,a.Property.AUTOCOUNT].forEach(function(e){(f[e]=f[e]||[]).push({enumSpec:p[e],index:d})})}return new e(n,f,t)},Object.defineProperty(e.prototype,"enumSpecIndex",{get:function(){return this._enumSpecIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this._schema},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specQuery",{get:function(){return this._spec},enumerable:!0,configurable:!0}),e.prototype.duplicate=function(){return new e(s.duplicate(this._spec),this._enumSpecIndex,this._schema,s.duplicate(this._enumSpecAssignment))},e.prototype.setMark=function(e){var n=this._spec.mark.name;this._enumSpecAssignment[n]=this._spec.mark=e},e.prototype.resetMark=function(){var e=this._spec.mark=this._enumSpecIndex.mark.enumSpec;delete this._enumSpecAssignment[e.name]},e.prototype.getMark=function(){return this._spec.mark},e.prototype.getEncodingProperty=function(e,n){return this._spec.encodings[e][n]},e.prototype.setEncodingProperty=function(e,n,t,r){var i=this._spec.encodings[e];n===a.Property.CHANNEL&&i.channel&&!c.isEnumSpec(i.channel)&&delete this._encodingMap[i.channel],i[n]=t,this._enumSpecAssignment[r.name]=t,n===a.Property.CHANNEL&&(this._encodingMap[t]=i)},e.prototype.resetEncodingProperty=function(e,n,t){var r=this._spec.encodings[e];n===a.Property.CHANNEL&&delete this._encodingMap[r.channel],r[n]=t,delete this._enumSpecAssignment[t.name]},e.prototype.channelUsed=function(e){return!!this._encodingMap[e]},e.prototype.getEncodings=function(){return this._spec.encodings},e.prototype.getEncodingQueryByChannel=function(e){return this._encodingMap[e]},e.prototype.getEncodingQueryByIndex=function(e){return this._spec.encodings[e]},e.prototype.isDimension=function(e){var n=this._encodingMap[e];return n&&c.isDimension(n)},e.prototype.isMeasure=function(e){var n=this._encodingMap[e];return n&&c.isMeasure(n)},e.prototype.isAggregate=function(){return s.some(this._spec.encodings,function(e){return!c.isEnumSpec(e.aggregate)&&!!e.aggregate||e.autoCount===!0})},e.prototype.toShorthand=function(){return c.stringifySpecQuery(this._spec)},e.prototype.toSpec=function(e){if(c.isEnumSpec(this._spec.mark))return null;for(var n={},t=0;t<this._spec.encodings.length;t++){var r=this._spec.encodings[t];if(c.isEnumSpec(r.channel))return null;for(var i={},f=[a.Property.AGGREGATE,a.Property.BIN,a.Property.TIMEUNIT,a.Property.FIELD,a.Property.TYPE],l=0;l<f.length;l++){var p=f[l];if(c.isEnumSpec(r[p]))return null;void 0!==r[p]&&(i[p]=r[p])}if(r.autoCount===!0)i.aggregate=o.AggregateOp.COUNT,i.field="*",i.type=u.Type.QUANTITATIVE;else if(r.autoCount===!1)continue;n[r.channel]=i}return s.extend(e?{data:e}:{},{mark:this._spec.mark,encoding:n})},e}();t.SpecQueryModel=f},{"./property":9,"./query":10,"./util":13,"vega-lite/src/aggregate":24,"vega-lite/src/type":29}],9:[function(e,n,t){"use strict";!function(e){e[e.MARK="mark"]="MARK",e[e.CHANNEL="channel"]="CHANNEL",e[e.AGGREGATE="aggregate"]="AGGREGATE",e[e.AUTOCOUNT="autoCount"]="AUTOCOUNT",e[e.BIN="bin"]="BIN",e[e.TIMEUNIT="timeUnit"]="TIMEUNIT",e[e.FIELD="field"]="FIELD",e[e.TYPE="type"]="TYPE"}(t.Property||(t.Property={}));var r=t.Property;t.ENCODING_PROPERTIES=[r.CHANNEL,r.BIN,r.TIMEUNIT,r.AGGREGATE,r.AUTOCOUNT,r.FIELD,r.TYPE]},{}],10:[function(e,n,t){"use strict";function r(e){return e===t.SHORT_ENUM_SPEC||void 0!==e&&!!e.enumValues}function i(e,n,t){return{name:e.name||n,enumValues:e.enumValues||t}}function o(e){return(r(e)?t.SHORT_ENUM_SPEC:e)+""}function u(e){var n=o(e.mark),t=e.encodings.map(s).sort().join("|");return n+"|"+t}function a(e){return T.isin(e.type,[h.Type.NOMINAL,h.Type.ORDINAL])||!r(e.bin)&&!!e.bin||!r(e.timeUnit)&&!!e.timeUnit}function c(e){return e.type===h.Type.QUANTITATIVE&&!e.bin||e.type===h.Type.TEMPORAL&&!e.timeUnit}function s(e){return o(e.channel)+":"+f(e)}function f(e){var n=null;e.aggregate&&!r(e.aggregate)?n=e.aggregate:e.timeUnit&&!r(e.timeUnit)?n=e.timeUnit:e.bin&&!r(e.bin)?n="bin":e.autoCount&&!r(e.autoCount)?n="count":(e.aggregate&&r(e.aggregate)||e.autoCount&&r(e.autoCount)||e.timeUnit&&r(e.timeUnit)||e.bin&&r(e.bin))&&(n=t.SHORT_ENUM_SPEC+"");var i=o(e.field||"*")+","+o(e.type||h.Type.QUANTITATIVE).substr(0,1);return n?n+"("+i+")":i}var l=e("vega-lite/src/channel"),p=e("vega-lite/src/aggregate"),d=e("vega-lite/src/mark"),y=e("vega-lite/src/timeunit"),h=e("vega-lite/src/Type"),E=e("./property"),T=e("./util");t.DEFAULT_QUERY_CONFIG={verbose:!1,propertyPrecedence:[E.Property.TYPE,E.Property.FIELD,E.Property.BIN,E.Property.TIMEUNIT,E.Property.AGGREGATE,E.Property.AUTOCOUNT,E.Property.CHANNEL,E.Property.MARK],marks:[d.Mark.POINT,d.Mark.BAR,d.Mark.LINE,d.Mark.AREA,d.Mark.TICK],channels:[l.X,l.Y,l.ROW,l.COLUMN,l.SIZE,l.COLOR],aggregates:[void 0,p.AggregateOp.MEAN],timeUnits:[y.TimeUnit.MONTH],types:[h.Type.NOMINAL,h.Type.ORDINAL,h.Type.QUANTITATIVE,h.Type.TEMPORAL],autoAddCount:!1,omitFacetOverPositionalChannels:!0,omitMultipleNonPositionalChannels:!0,omitRawBarLineArea:!0,omitRawContinuousFieldForAggregatePlot:!0,omitRepeatedField:!0,omitNonPositionalOverPositionalChannels:!0,omitVerticalDotPlot:!0,preferredBinAxis:l.Channel.X,preferredTemporalAxis:l.Channel.X,preferredOrdinalAxis:l.Channel.Y,preferredNominalAxis:l.Channel.Y,maxCardinalityForCategoricalColor:20,maxCardinalityForFacet:10,maxCardinalityForShape:6,typeMatchesSchemaType:!0},function(e){e[e.ENUMSPEC="?"]="ENUMSPEC"}(t.ShortEnumSpec||(t.ShortEnumSpec={}));var g=t.ShortEnumSpec;t.SHORT_ENUM_SPEC=g.ENUMSPEC,t.isEnumSpec=r,t.initEnumSpec=i,t.stringifySpecQuery=u,t.isDimension=a,t.isMeasure=c,t.stringifyEncodingQuery=s,t.stringifyEncodingQueryFieldDef=f},{"./property":9,"./util":13,"vega-lite/src/Type":23,"vega-lite/src/aggregate":24,"vega-lite/src/channel":25,"vega-lite/src/mark":27,"vega-lite/src/timeunit":28}],11:[function(e,n,t){"use strict";var r=function(){function e(e){this.fieldSchemas=e,this.fieldSchemaIndex=e.reduce(function(e,n){return e[n.field]=n,e},{})}return e.prototype.fields=function(){return this.fieldSchemas.map(function(e){return e.field})},e.prototype.primitiveType=function(e){return this.fieldSchemaIndex[e]?this.fieldSchemaIndex[e].primitiveType:null},e.prototype.type=function(e){return this.fieldSchemaIndex[e]?this.fieldSchemaIndex[e].type:null},e}();t.Schema=r,function(e){e[e.STRING="string"]="STRING",e[e.NUMBER="number"]="NUMBER",e[e.INTEGER="integer"]="INTEGER",e[e.BOOLEAN="boolean"]="BOOLEAN",e[e.DATE="date"]="DATE"}(t.PrimitiveType||(t.PrimitiveType={}));t.PrimitiveType},{}],12:[function(e,n,t){"use strict";var r=function(){function e(e){this._fieldsStats=e,this._fieldStatsIndex=e.reduce(function(e,n){return e[n.field]=n,e},{})}return e.prototype.cardinality=function(e){return e.aggregate||e.autoCount?1:e.bin?1:e.timeUnit?1:this._fieldStatsIndex[e.field].distinct},e}();t.Stats=r},{}],13:[function(e,n,t){"use strict";function r(e,n){return-1!==n.indexOf(e)}function i(e){var n,t=[];for(n in e)t.push(n);return t}function o(e){return JSON.parse(JSON.stringify(e))}function u(e,n){var t,r=0;for(t in e)if(!n(e[t],t,r++))return!1;return!0}function a(e,n){var t,r=0;for(t in e)if(n(e[t],t,r++))return!0;return!1}function c(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];for(var i,o,u=1,a=arguments.length;a>u;++u){i=arguments[u];for(o in i)e[o]=i[o]}return e}t.isin=r,t.keys=i,t.duplicate=o,t.every=u,t.some=a,t.extend=c},{}],14:[function(n,t,r){!function(n,i){"object"==typeof r&&"undefined"!=typeof t?i(r):"function"==typeof e&&e.amd?e("d3-time",["exports"],i):i(n.d3_time={})}(this,function(e){"use strict";function n(e,t,r,u){function a(n){return e(n=new Date(+n)),n}return a.floor=a,a.round=function(n){var r=new Date(+n),i=new Date(n-1);return e(r),e(i),t(i,1),i-n>n-r?r:i},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o=[];if(n=new Date(n-1),r=new Date(+r),i=null==i?1:Math.floor(i),!(r>n&&i>0))return o;for(t(n,1),e(n),r>n&&o.push(new Date(+n));t(n,i),e(n),r>n;)o.push(new Date(+n));return o},a.filter=function(r){return n(function(n){for(;e(n),!r(n);)n.setTime(n-1)},function(e,n){for(;--n>=0;)for(;t(e,1),!r(e););})},r&&(a.count=function(n,t){return i.setTime(+n),o.setTime(+t),e(i),e(o),Math.floor(r(i,o))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(u?function(n){return u(n)%e===0}:function(n){return a.count(0,n)%e===0}):a:null}),a}function t(e){return n(function(n){n.setHours(0,0,0,0),n.setDate(n.getDate()-(n.getDay()+7-e)%7)},function(e,n){e.setDate(e.getDate()+7*n)},function(e,n){return(n-e-6e4*(n.getTimezoneOffset()-e.getTimezoneOffset()))/6048e5})}function r(e){return n(function(n){n.setUTCHours(0,0,0,0),n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-e)%7)},function(e,n){e.setUTCDate(e.getUTCDate()+7*n)},function(e,n){return(n-e)/6048e5})}var i=new Date,o=new Date,u=n(function(){},function(e,n){e.setTime(+e+n)},function(e,n){return n-e});u.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?n(function(n){n.setTime(Math.floor(n/e)*e)},function(n,t){n.setTime(+n+t*e)},function(n,t){return(t-n)/e}):u:null};var a=n(function(e){e.setMilliseconds(0)},function(e,n){e.setTime(+e+1e3*n)},function(e,n){return(n-e)/1e3},function(e){return e.getSeconds()}),c=n(function(e){e.setSeconds(0,0)},function(e,n){e.setTime(+e+6e4*n)},function(e,n){return(n-e)/6e4},function(e){return e.getMinutes()}),s=n(function(e){e.setMinutes(0,0,0)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getHours()}),f=n(function(e){e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n)},function(e,n){return(n-e-6e4*(n.getTimezoneOffset()-e.getTimezoneOffset()))/864e5},function(e){return e.getDate()-1}),l=t(0),p=t(1),d=t(2),y=t(3),h=t(4),E=t(5),T=t(6),g=n(function(e){e.setHours(0,0,0,0),e.setDate(1)},function(e,n){e.setMonth(e.getMonth()+n)},function(e,n){return n.getMonth()-e.getMonth()+12*(n.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),A=n(function(e){e.setHours(0,0,0,0),e.setMonth(0,1)},function(e,n){e.setFullYear(e.getFullYear()+n)},function(e,n){return n.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}),m=n(function(e){e.setUTCMilliseconds(0)},function(e,n){e.setTime(+e+1e3*n)},function(e,n){return(n-e)/1e3},function(e){return e.getUTCSeconds()}),N=n(function(e){e.setUTCSeconds(0,0)},function(e,n){e.setTime(+e+6e4*n)},function(e,n){return(n-e)/6e4},function(e){return e.getUTCMinutes()}),S=n(function(e){e.setUTCMinutes(0,0,0)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getUTCHours()}),C=n(function(e){e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n)},function(e,n){return(n-e)/864e5},function(e){return e.getUTCDate()-1}),O=r(0),M=r(1),v=r(2),I=r(3),P=r(4),R=r(5),U=r(6),D=n(function(e){e.setUTCHours(0,0,0,0),e.setUTCDate(1)},function(e,n){e.setUTCMonth(e.getUTCMonth()+n)},function(e,n){return n.getUTCMonth()-e.getUTCMonth()+12*(n.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),L=n(function(e){e.setUTCHours(0,0,0,0),e.setUTCMonth(0,1)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n)},function(e,n){return n.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}),b=u.range,H=a.range,Y=c.range,w=s.range,x=f.range,_=l.range,F=p.range,k=d.range,B=y.range,G=h.range,q=E.range,j=T.range,V=l.range,Q=g.range,X=A.range,K=u,W=b,J=m.range,z=N.range,$=S.range,Z=C.range,ee=O.range,ne=M.range,te=v.range,re=I.range,ie=P.range,oe=R.range,ue=U.range,ae=O.range,ce=D.range,se=L.range,fe="0.1.1";e.version=fe,e.milliseconds=b,e.seconds=H,e.minutes=Y,e.hours=w,e.days=x,e.sundays=_,e.mondays=F,e.tuesdays=k,e.wednesdays=B,e.thursdays=G,e.fridays=q,e.saturdays=j,e.weeks=V,e.months=Q,e.years=X,e.utcMillisecond=K,e.utcMilliseconds=W,e.utcSeconds=J,e.utcMinutes=z,e.utcHours=$,e.utcDays=Z,e.utcSundays=ee,e.utcMondays=ne,e.utcTuesdays=te,e.utcWednesdays=re,e.utcThursdays=ie,e.utcFridays=oe,e.utcSaturdays=ue,e.utcWeeks=ae,e.utcMonths=ce,e.utcYears=se,e.millisecond=u,e.second=a,e.minute=c,e.hour=s,e.day=f,e.sunday=l,e.monday=p,e.tuesday=d,e.wednesday=y,e.thursday=h,e.friday=E,e.saturday=T,e.week=l,e.month=g,e.year=A,e.utcSecond=m,e.utcMinute=N,e.utcHour=S,e.utcDay=C,e.utcSunday=O,e.utcMonday=M,e.utcTuesday=v,e.utcWednesday=I,e.utcThursday=P,e.utcFriday=R,e.utcSaturday=U,e.utcWeek=O,e.utcMonth=D,e.utcYear=L,e.interval=n})},{}],15:[function(e,n,t){function r(e){if(!e)throw Error("Missing binning options.");var n,t,r,a,c,s,f,l=e.maxbins||15,p=e.base||10,d=Math.log(p),y=e.div||[5,2],h=e.min,E=e.max,T=E-h;if(e.step)n=e.step;else if(e.steps)n=e.steps[Math.min(e.steps.length-1,i(e.steps,T/l,0,e.steps.length))];else{for(t=Math.ceil(Math.log(l)/d),r=e.minstep||0,n=Math.max(r,Math.pow(p,Math.round(Math.log(T)/d)-t));Math.ceil(T/n)>l;)n*=p;for(s=0;s<y.length;++s)c=n/y[s],c>=r&&l>=T/c&&(n=c)}return c=Math.log(n),a=c>=0?0:~~(-c/d)+1,f=Math.pow(p,-a-1),h=Math.min(h,Math.floor(h/n+f)*n),E=Math.ceil(E/n)*n,{start:h,stop:E,step:n,unit:{precision:a},value:o,index:u}}function i(e,n,t,r){for(;r>t;){var i=t+r>>>1;s.cmp(e[i],n)<0?t=i+1:r=i}return t}function o(e){return this.step*Math.floor(e/this.step+l)}function u(e){return Math.floor((e-this.start)/this.step+l)}function a(e){return this.unit.date(o.call(this,e))}function c(e){return u.call(this,this.unit.unit(e))}var s=e("../util"),f=e("../time"),l=1e-15;r.date=function(e){if(!e)throw Error("Missing date binning options.");var n=e.utc?f.utc:f,t=e.min,i=e.max,o=e.maxbins||20,u=e.minbins||4,s=+i-+t,l=e.unit?n[e.unit]:n.find(s,u,o),p=r({
min:null!=l.min?l.min:l.unit(t),max:null!=l.max?l.max:l.unit(i),maxbins:o,minstep:l.minstep,steps:l.step});return p.unit=l,p.index=c,e.raw||(p.value=a),p},n.exports=r},{"../time":17,"../util":18}],16:[function(e,n,t){var r=e("./util"),i=n.exports;i.repeat=function(e,n){var t,r=Array(n);for(t=0;n>t;++t)r[t]=e;return r},i.zeros=function(e){return i.repeat(0,e)},i.range=function(e,n,t){if(arguments.length<3&&(t=1,arguments.length<2&&(n=e,e=0)),(n-e)/t==1/0)throw new Error("Infinite range");var r,i=[],o=-1;if(0>t)for(;(r=e+t*++o)>n;)i.push(r);else for(;(r=e+t*++o)<n;)i.push(r);return i},i.random={},i.random.uniform=function(e,n){void 0===n&&(n=void 0===e?1:e,e=0);var t=n-e,r=function(){return e+t*Math.random()};return r.samples=function(e){return i.zeros(e).map(r)},r.pdf=function(r){return r>=e&&n>=r?1/t:0},r.cdf=function(r){return e>r?0:r>n?1:(r-e)/t},r.icdf=function(n){return n>=0&&1>=n?e+n*t:NaN},r},i.random.integer=function(e,n){void 0===n&&(n=e,e=0);var t=n-e,r=function(){return e+Math.floor(t*Math.random())};return r.samples=function(e){return i.zeros(e).map(r)},r.pdf=function(r){return r===Math.floor(r)&&r>=e&&n>r?1/t:0},r.cdf=function(r){var i=Math.floor(r);return e>i?0:i>=n?1:(i-e+1)/t},r.icdf=function(n){return n>=0&&1>=n?e-1+Math.floor(n*t):NaN},r},i.random.normal=function(e,n){e=e||0,n=n||1;var t,r=function(){var r,i,o=0,u=0;if(void 0!==t)return o=t,t=void 0,o;do o=2*Math.random()-1,u=2*Math.random()-1,r=o*o+u*u;while(0===r||r>1);return i=Math.sqrt(-2*Math.log(r)/r),t=e+u*i*n,e+o*i*n};return r.samples=function(e){return i.zeros(e).map(r)},r.pdf=function(t){var r=Math.exp(Math.pow(t-e,2)/(-2*Math.pow(n,2)));return 1/(n*Math.sqrt(2*Math.PI))*r},r.cdf=function(t){var r,i=(t-e)/n,o=Math.abs(i);if(o>37)r=0;else{var u,a=Math.exp(-o*o/2);7.07106781186547>o?(u=.0352624965998911*o+.700383064443688,u=u*o+6.37396220353165,u=u*o+33.912866078383,u=u*o+112.079291497871,u=u*o+221.213596169931,u=u*o+220.206867912376,r=a*u,u=.0883883476483184*o+1.75566716318264,u=u*o+16.064177579207,u=u*o+86.7807322029461,u=u*o+296.564248779674,u=u*o+637.333633378831,u=u*o+793.826512519948,u=u*o+440.413735824752,r/=u):(u=o+.65,u=o+4/u,u=o+3/u,u=o+2/u,u=o+1/u,r=a/u/2.506628274631)}return i>0?1-r:r},r.icdf=function(t){if(0>=t||t>=1)return NaN;var r=2*t-1,i=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),o=2/(Math.PI*i)+Math.log(1-Math.pow(r,2))/2,u=Math.log(1-r*r)/i,a=(r>0?1:-1)*Math.sqrt(Math.sqrt(o*o-u)-o);return e+n*Math.SQRT2*a},r},i.random.bootstrap=function(e,n){var t=e.filter(r.isValid),o=t.length,u=n?i.random.normal(0,n):null,a=function(){return t[~~(Math.random()*o)]+(u?u():0)};return a.samples=function(e){return i.zeros(e).map(a)},a}},{"./util":18}],17:[function(e,n,t){function r(e){return s.setTime(+e),s}function i(e,n,t,r,i,o){var u={type:e,date:n,unit:t};return r?u.step=r:u.minstep=1,null!=i&&(u.min=i),null!=o&&(u.max=o),u}function o(e,n,t,r,o,u){return i(e,function(e){return n.offset(t,e)},function(e){return n.count(t,e)},r,o,u)}function u(e,n,t,r){var i,o,u,a=y[0];for(i=1,o=y.length;o>i;++i)if(a=y[i],n>a[0]){if(u=n/a[0],u>r)return e[y[i-1][1]];if(u>=t)return e[a[1]]}return e[y[o-1][1]]}function a(e){var n,t,r={};for(n=0,t=e.length;t>n;++n)r[e[n].type]=e[n];return r.find=function(n,t,r){return u(e,n,t,r)},r}var c=e("d3-time"),s=new Date,f=new Date(0,0,1).setFullYear(0),l=new Date(Date.UTC(0,0,1)).setUTCFullYear(0),p=[o("second",c.second,f),o("minute",c.minute,f),o("hour",c.hour,f),o("day",c.day,f,[1,7]),o("month",c.month,f,[1,3,6]),o("year",c.year,f),i("seconds",function(e){return new Date(1970,0,1,0,0,e)},function(e){return r(e).getSeconds()},null,0,59),i("minutes",function(e){return new Date(1970,0,1,0,e)},function(e){return r(e).getMinutes()},null,0,59),i("hours",function(e){return new Date(1970,0,1,e)},function(e){return r(e).getHours()},null,0,23),i("weekdays",function(e){return new Date(1970,0,4+e)},function(e){return r(e).getDay()},[1],0,6),i("dates",function(e){return new Date(1970,0,e)},function(e){return r(e).getDate()},[1],1,31),i("months",function(e){return new Date(1970,e%12,1)},function(e){return r(e).getMonth()},[1],0,11)],d=[o("second",c.utcSecond,l),o("minute",c.utcMinute,l),o("hour",c.utcHour,l),o("day",c.utcDay,l,[1,7]),o("month",c.utcMonth,l,[1,3,6]),o("year",c.utcYear,l),i("seconds",function(e){return new Date(Date.UTC(1970,0,1,0,0,e))},function(e){return r(e).getUTCSeconds()},null,0,59),i("minutes",function(e){return new Date(Date.UTC(1970,0,1,0,e))},function(e){return r(e).getUTCMinutes()},null,0,59),i("hours",function(e){return new Date(Date.UTC(1970,0,1,e))},function(e){return r(e).getUTCHours()},null,0,23),i("weekdays",function(e){return new Date(Date.UTC(1970,0,4+e))},function(e){return r(e).getUTCDay()},[1],0,6),i("dates",function(e){return new Date(Date.UTC(1970,0,e))},function(e){return r(e).getUTCDate()},[1],1,31),i("months",function(e){return new Date(Date.UTC(1970,e%12,1))},function(e){return r(e).getUTCMonth()},[1],0,11)],y=[[31536e6,5],[7776e6,4],[2592e6,4],[12096e5,3],[6048e5,3],[1728e5,3],[864e5,3],[432e5,2],[216e5,2],[108e5,2],[36e5,2],[18e5,1],[9e5,1],[3e5,1],[6e4,1],[3e4,0],[15e3,0],[5e3,0],[1e3,0]];n.exports=a(p),n.exports.utc=a(d)},{"d3-time":14}],18:[function(e,n,t){(function(e){function t(e,n){var t,r="";for(t=0;e>t;++t)r+=n;return r}function r(e,n,t){var r=0,i=e.split(c);return e=t?(i=i.reverse()).filter(function(e){return r+=e.length,n>=r}).reverse():i.filter(function(e){return r+=e.length,n>=r}),e.length?e.join("").trim():i[0].slice(0,n)}var i=n.exports,o="__name__";i.namedfunc=function(e,n){return n[o]=e,n},i.name=function(e){return null==e?null:e[o]},i.identity=function(e){return e},i["true"]=i.namedfunc("true",function(){return!0}),i["false"]=i.namedfunc("false",function(){return!1}),i.duplicate=function(e){return JSON.parse(JSON.stringify(e))},i.equal=function(e,n){return JSON.stringify(e)===JSON.stringify(n)},i.extend=function(e){for(var n,t,r=1,i=arguments.length;i>r;++r){n=arguments[r];for(t in n)e[t]=n[t]}return e},i.length=function(e){return null!=e&&null!=e.length?e.length:null},i.keys=function(e){var n,t=[];for(n in e)t.push(n);return t},i.vals=function(e){var n,t=[];for(n in e)t.push(e[n]);return t},i.toMap=function(e,n){return(n=i.$(n))?e.reduce(function(e,t){return e[n(t)]=1,e},{}):e.reduce(function(e,n){return e[n]=1,e},{})},i.keystr=function(e){var n=e.length;if(!n)return"";for(var t=String(e[0]),r=1;n>r;++r)t+="|"+String(e[r]);return t};var u=Object.prototype.toString;i.isObject=function(e){return e===Object(e)},i.isFunction=function(e){return"[object Function]"===u.call(e)},i.isString=function(e){return"string"==typeof value||"[object String]"===u.call(e)},i.isArray=Array.isArray||function(e){return"[object Array]"===u.call(e)},i.isNumber=function(e){return"number"==typeof e||"[object Number]"===u.call(e)},i.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==u.call(e)},i.isDate=function(e){return"[object Date]"===u.call(e)},i.isValid=function(e){return null!=e&&e===e},i.isBuffer="function"==typeof e&&e.isBuffer||i["false"],i.number=function(e){return null==e||""===e?null:+e},i["boolean"]=function(e){return null==e||""===e?null:"false"===e?!1:!!e},i.date=function(e,n){var t=n?n:Date;return null==e||""===e?null:t.parse(e)},i.array=function(e){return null!=e?i.isArray(e)?e:[e]:[]},i.str=function(e){return i.isArray(e)?"["+e.map(i.str)+"]":i.isObject(e)||i.isString(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e};var a=/\[(.*?)\]|[^.\[]+/g;i.field=function(e){return String(e).match(a).map(function(e){return"["!==e[0]?e:"'"!==e[1]&&'"'!==e[1]?e.slice(1,-1):e.slice(2,-2).replace(/\\(["'])/g,"$1")})},i.accessor=function(e){return null==e||i.isFunction(e)?e:i.namedfunc(e,Function("x","return x["+i.field(e).map(i.str).join("][")+"];"))},i.$=i.accessor,i.mutator=function(e){var n;return i.isString(e)&&(n=i.field(e)).length>1?function(e,t){for(var r=0;r<n.length-1;++r)e=e[n[r]];e[n[r]]=t}:function(n,t){n[e]=t}},i.$func=function(e,n){return function(t){t=i.$(t)||i.identity;var r=e+(i.name(t)?"_"+i.name(t):"");return i.namedfunc(r,function(e){return n(t(e))})}},i.$valid=i.$func("valid",i.isValid),i.$length=i.$func("length",i.length),i.$in=function(e,n){e=i.$(e);var t=i.isArray(n)?i.toMap(n):n;return function(n){return!!t[e(n)]}},i.comparator=function(e){var n=[];return void 0===e&&(e=[]),e=i.array(e).map(function(e){var t=1;return"-"===e[0]?(t=-1,e=e.slice(1)):"+"===e[0]&&(t=1,e=e.slice(1)),n.push(t),i.accessor(e)}),function(t,r){var i,o,u,a,c;for(i=0,o=e.length;o>i;++i){if(u=e[i],a=u(t),c=u(r),c>a)return-1*n[i];if(a>c)return n[i]}return 0}},i.cmp=function(e,n){return n>e?-1:e>n?1:e>=n?0:null===e?-1:null===n?1:NaN},i.numcmp=function(e,n){return e-n},i.stablesort=function(e,n,t){var r=e.reduce(function(e,n,r){return e[t(n)]=r,e},{});return e.sort(function(e,i){var o=n(e),u=n(i);return u>o?-1:o>u?1:r[t(e)]-r[t(i)]}),e},i.pad=function(e,n,r,i){i=i||" ";var o=n-e.length;if(0>=o)return e;switch(r){case"left":return t(o,i)+e;case"middle":case"center":return t(Math.floor(o/2),i)+e+t(Math.ceil(o/2),i);default:return e+t(o,i)}},i.truncate=function(e,n,t,i,o){var u=e.length;if(n>=u)return e;o=void 0!==o?String(o):"…";var a=Math.max(0,n-o.length);switch(t){case"left":return o+(i?r(e,a,1):e.slice(u-a));case"middle":case"center":var c=Math.ceil(a/2),s=Math.floor(a/2);return(i?r(e,c):e.slice(0,c))+o+(i?r(e,s,1):e.slice(u-s));default:return(i?r(e,a):e.slice(0,a))+o}};var c=/([\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u2028\u2029\u3000\uFEFF])/}).call(this,e("buffer").Buffer)},{buffer:1}],19:[function(e,n,t){var r="undefined"!=typeof JSON?JSON:e("jsonify");n.exports=function(e,n){n||(n={}),"function"==typeof n&&(n={cmp:n});var t=n.space||"";"number"==typeof t&&(t=Array(t+1).join(" "));var u="boolean"==typeof n.cycles?n.cycles:!1,a=n.replacer||function(e,n){return n},c=n.cmp&&function(e){return function(n){return function(t,r){var i={key:t,value:n[t]},o={key:r,value:n[r]};return e(i,o)}}}(n.cmp),s=[];return function f(e,n,l,p){var d=t?"\n"+new Array(p+1).join(t):"",y=t?": ":":";if(l&&l.toJSON&&"function"==typeof l.toJSON&&(l=l.toJSON()),l=a.call(e,n,l),void 0!==l){if("object"!=typeof l||null===l)return r.stringify(l);if(i(l)){for(var h=[],E=0;E<l.length;E++){var T=f(l,E,l[E],p+1)||r.stringify(null);h.push(d+t+T)}return"["+h.join(",")+d+"]"}if(-1!==s.indexOf(l)){if(u)return r.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}s.push(l);for(var g=o(l).sort(c&&c(l)),h=[],E=0;E<g.length;E++){var n=g[E],A=f(l,n,l[n],p+1);if(A){var m=r.stringify(n)+y+A;h.push(d+t+m)}}return s.splice(s.indexOf(l),1),"{"+h.join(",")+d+"}"}}({"":e},"",e,0)};var i=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},o=Object.keys||function(e){var n=Object.prototype.hasOwnProperty||function(){return!0},t=[];for(var r in e)n.call(e,r)&&t.push(r);return t}},{jsonify:20}],20:[function(e,n,t){t.parse=e("./lib/parse"),t.stringify=e("./lib/stringify")},{"./lib/parse":21,"./lib/stringify":22}],21:[function(e,n,t){var r,i,o,u,a={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},c=function(e){throw{name:"SyntaxError",message:e,at:r,text:o}},s=function(e){return e&&e!==i&&c("Expected '"+e+"' instead of '"+i+"'"),i=o.charAt(r),r+=1,i},f=function(){var e,n="";for("-"===i&&(n="-",s("-"));i>="0"&&"9">=i;)n+=i,s();if("."===i)for(n+=".";s()&&i>="0"&&"9">=i;)n+=i;if("e"===i||"E"===i)for(n+=i,s(),"-"!==i&&"+"!==i||(n+=i,s());i>="0"&&"9">=i;)n+=i,s();return e=+n,isFinite(e)?e:void c("Bad number")},l=function(){var e,n,t,r="";if('"'===i)for(;s();){if('"'===i)return s(),r;if("\\"===i)if(s(),"u"===i){for(t=0,n=0;4>n&&(e=parseInt(s(),16),isFinite(e));n+=1)t=16*t+e;r+=String.fromCharCode(t)}else{if("string"!=typeof a[i])break;r+=a[i]}else r+=i}c("Bad string")},p=function(){for(;i&&" ">=i;)s()},d=function(){switch(i){case"t":return s("t"),s("r"),s("u"),s("e"),!0;case"f":return s("f"),s("a"),s("l"),s("s"),s("e"),!1;case"n":return s("n"),s("u"),s("l"),s("l"),null}c("Unexpected '"+i+"'")},y=function(){var e=[];if("["===i){if(s("["),p(),"]"===i)return s("]"),e;for(;i;){if(e.push(u()),p(),"]"===i)return s("]"),e;s(","),p()}}c("Bad array")},h=function(){var e,n={};if("{"===i){if(s("{"),p(),"}"===i)return s("}"),n;for(;i;){if(e=l(),p(),s(":"),Object.hasOwnProperty.call(n,e)&&c('Duplicate key "'+e+'"'),n[e]=u(),p(),"}"===i)return s("}"),n;s(","),p()}}c("Bad object")};u=function(){switch(p(),i){case"{":return h();case"[":return y();case'"':return l();case"-":return f();default:return i>="0"&&"9">=i?f():d()}},n.exports=function(e,n){var t;return o=e,r=0,i=" ",t=u(),p(),i&&c("Syntax error"),"function"==typeof n?function a(e,t){var r,i,o=e[t];if(o&&"object"==typeof o)for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(i=a(o,r),void 0!==i?o[r]=i:delete o[r]);return n.call(e,t,o)}({"":t},""):t}},{}],22:[function(e,n,t){function r(e){return c.lastIndex=0,c.test(e)?'"'+e.replace(c,function(e){var n=s[e];return"string"==typeof n?n:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function i(e,n){var t,c,s,f,l,p=o,d=n[e];switch(d&&"object"==typeof d&&"function"==typeof d.toJSON&&(d=d.toJSON(e)),"function"==typeof a&&(d=a.call(n,e,d)),typeof d){case"string":return r(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(o+=u,l=[],"[object Array]"===Object.prototype.toString.apply(d)){for(f=d.length,t=0;f>t;t+=1)l[t]=i(t,d)||"null";return s=0===l.length?"[]":o?"[\n"+o+l.join(",\n"+o)+"\n"+p+"]":"["+l.join(",")+"]",o=p,s}if(a&&"object"==typeof a)for(f=a.length,t=0;f>t;t+=1)c=a[t],"string"==typeof c&&(s=i(c,d),s&&l.push(r(c)+(o?": ":":")+s));else for(c in d)Object.prototype.hasOwnProperty.call(d,c)&&(s=i(c,d),s&&l.push(r(c)+(o?": ":":")+s));return s=0===l.length?"{}":o?"{\n"+o+l.join(",\n"+o)+"\n"+p+"}":"{"+l.join(",")+"}",o=p,s}}var o,u,a,c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};n.exports=function(e,n,t){var r;if(o="",u="","number"==typeof t)for(r=0;t>r;r+=1)u+=" ";else"string"==typeof t&&(u=t);if(a=n,n&&"function"!=typeof n&&("object"!=typeof n||"number"!=typeof n.length))throw new Error("JSON.stringify");return i("",{"":e})}},{}],23:[function(e,n,t){"use strict";function r(e){var n=e;return t.TYPE_FROM_SHORT_TYPE[n.toUpperCase()]||n.toLowerCase()}!function(e){e[e.QUANTITATIVE="quantitative"]="QUANTITATIVE",e[e.ORDINAL="ordinal"]="ORDINAL",e[e.TEMPORAL="temporal"]="TEMPORAL",e[e.NOMINAL="nominal"]="NOMINAL"}(t.Type||(t.Type={}));var i=t.Type;t.QUANTITATIVE=i.QUANTITATIVE,t.ORDINAL=i.ORDINAL,t.TEMPORAL=i.TEMPORAL,t.NOMINAL=i.NOMINAL,t.SHORT_TYPE={quantitative:"Q",temporal:"T",nominal:"N",ordinal:"O"},t.TYPE_FROM_SHORT_TYPE={Q:t.QUANTITATIVE,T:t.TEMPORAL,O:t.ORDINAL,N:t.NOMINAL},t.getFullName=r},{}],24:[function(e,n,t){"use strict";!function(e){e[e.VALUES="values"]="VALUES",e[e.COUNT="count"]="COUNT",e[e.VALID="valid"]="VALID",e[e.MISSING="missing"]="MISSING",e[e.DISTINCT="distinct"]="DISTINCT",e[e.SUM="sum"]="SUM",e[e.MEAN="mean"]="MEAN",e[e.AVERAGE="average"]="AVERAGE",e[e.VARIANCE="variance"]="VARIANCE",e[e.VARIANCEP="variancep"]="VARIANCEP",e[e.STDEV="stdev"]="STDEV",e[e.STDEVP="stdevp"]="STDEVP",e[e.MEDIAN="median"]="MEDIAN",e[e.Q1="q1"]="Q1",e[e.Q3="q3"]="Q3",e[e.MODESKEW="modeskew"]="MODESKEW",e[e.MIN="min"]="MIN",e[e.MAX="max"]="MAX",e[e.ARGMIN="argmin"]="ARGMIN",e[e.ARGMAX="argmax"]="ARGMAX"}(t.AggregateOp||(t.AggregateOp={}));var r=t.AggregateOp;t.AGGREGATE_OPS=[r.VALUES,r.COUNT,r.VALID,r.MISSING,r.DISTINCT,r.SUM,r.MEAN,r.AVERAGE,r.VARIANCE,r.VARIANCEP,r.STDEV,r.STDEVP,r.MEDIAN,r.Q1,r.Q3,r.MODESKEW,r.MIN,r.MAX,r.ARGMIN,r.ARGMAX],t.SHARED_DOMAIN_OPS=[r.MEAN,r.AVERAGE,r.STDEV,r.STDEVP,r.MEDIAN,r.Q1,r.Q3,r.MIN,r.MAX]},{}],25:[function(e,n,t){"use strict";function r(e,n){return!!i(e)[n]}function i(e){switch(e){case t.X:case t.Y:case t.COLOR:case t.DETAIL:case t.ORDER:case t.OPACITY:case t.ROW:case t.COLUMN:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,line:!0,area:!0,text:!0};case t.SIZE:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,text:!0};case t.SHAPE:return{point:!0};case t.TEXT:return{text:!0};case t.PATH:return{line:!0}}return{}}function o(e){switch(e){case t.X:case t.Y:case t.COLOR:case t.OPACITY:case t.LABEL:case t.DETAIL:return{measure:!0,dimension:!0};case t.ROW:case t.COLUMN:case t.SHAPE:return{measure:!1,dimension:!0};case t.SIZE:case t.TEXT:return{measure:!0,dimension:!1};case t.PATH:return{measure:!1,dimension:!0}}throw new Error("Invalid encoding channel"+e)}function u(e){return!a.contains([t.DETAIL,t.PATH,t.TEXT,t.LABEL,t.ORDER],e)}var a=e("./util");!function(e){e[e.X="x"]="X",e[e.Y="y"]="Y",e[e.ROW="row"]="ROW",e[e.COLUMN="column"]="COLUMN",e[e.SHAPE="shape"]="SHAPE",e[e.SIZE="size"]="SIZE",e[e.COLOR="color"]="COLOR",e[e.TEXT="text"]="TEXT",e[e.DETAIL="detail"]="DETAIL",e[e.LABEL="label"]="LABEL",e[e.PATH="path"]="PATH",e[e.ORDER="order"]="ORDER",e[e.OPACITY="opacity"]="OPACITY"}(t.Channel||(t.Channel={}));var c=t.Channel;t.X=c.X,t.Y=c.Y,t.ROW=c.ROW,t.COLUMN=c.COLUMN,t.SHAPE=c.SHAPE,t.SIZE=c.SIZE,t.COLOR=c.COLOR,t.TEXT=c.TEXT,t.DETAIL=c.DETAIL,t.LABEL=c.LABEL,t.PATH=c.PATH,t.ORDER=c.ORDER,t.OPACITY=c.OPACITY,t.CHANNELS=[t.X,t.Y,t.ROW,t.COLUMN,t.SIZE,t.SHAPE,t.COLOR,t.PATH,t.ORDER,t.OPACITY,t.TEXT,t.DETAIL,t.LABEL],t.UNIT_CHANNELS=a.without(t.CHANNELS,[t.ROW,t.COLUMN]),t.UNIT_SCALE_CHANNELS=a.without(t.UNIT_CHANNELS,[t.PATH,t.ORDER,t.DETAIL,t.TEXT,t.LABEL]),t.NONSPATIAL_CHANNELS=a.without(t.UNIT_CHANNELS,[t.X,t.Y]),t.NONSPATIAL_SCALE_CHANNELS=a.without(t.UNIT_SCALE_CHANNELS,[t.X,t.Y]),t.supportMark=r,t.getSupportedMark=i,t.getSupportedRole=o,t.hasScale=u},{"./util":30}],26:[function(e,n,t){"use strict";function r(e){var n=0;return e.color&&n++,e.opacity&&n++,e.size&&n++,e.shape&&n++,n}function i(e){return y.CHANNELS.filter(function(n){return o(e,n)})}function o(e,n){var t=e&&e[n];return t&&(void 0!==t.field||h.isArray(t)&&t.length>0)}function u(e){return h.any(y.CHANNELS,function(n){return!(!o(e,n)||!e[n].aggregate)})}function a(e){var n=[];return y.CHANNELS.forEach(function(t){o(e,t)&&(h.isArray(e[t])?e[t].forEach(function(e){n.push(e)}):n.push(e[t]))}),n}function c(e,n,t){s(y.CHANNELS,e,n,t)}function s(e,n,t,r){var i=0;e.forEach(function(e){o(n,e)&&(h.isArray(n[e])?n[e].forEach(function(n){t.call(r,n,e,i++)}):t.call(r,n[e],e,i++))})}function f(e,n,t){return l(y.CHANNELS,e,n,t)}function l(e,n,t,r){var i=[];return e.forEach(function(e){o(n,e)&&(h.isArray(n[e])?n[e].forEach(function(n){i.push(t.call(r,n,e))}):i.push(t.call(r,n[e],e)))}),i}function p(e,n,t,r){return d(y.CHANNELS,e,n,t,r)}function d(e,n,t,r,i){var u=r;return y.CHANNELS.forEach(function(e){o(n,e)&&(h.isArray(n[e])?n[e].forEach(function(n){u=t.call(i,u,n,e)}):u=t.call(i,u,n[e],e))}),u}var y=e("./channel"),h=e("./util");t.countRetinal=r,t.channels=i,t.has=o,t.isAggregate=u,t.fieldDefs=a,t.forEach=c,t.channelMappingForEach=s,t.map=f,t.channelMappingMap=l,t.reduce=p,t.channelMappingReduce=d},{"./channel":25,"./util":30}],27:[function(e,n,t){"use strict";!function(e){e[e.AREA="area"]="AREA",e[e.BAR="bar"]="BAR",e[e.LINE="line"]="LINE",e[e.POINT="point"]="POINT",e[e.TEXT="text"]="TEXT",e[e.TICK="tick"]="TICK",e[e.RULE="rule"]="RULE",e[e.CIRCLE="circle"]="CIRCLE",e[e.SQUARE="square"]="SQUARE"}(t.Mark||(t.Mark={}));var r=t.Mark;t.AREA=r.AREA,t.BAR=r.BAR,t.LINE=r.LINE,t.POINT=r.POINT,t.TEXT=r.TEXT,t.TICK=r.TICK,t.RULE=r.RULE,t.CIRCLE=r.CIRCLE,t.SQUARE=r.SQUARE},{}],28:[function(e,n,t){"use strict";function r(e,n){if(void 0===n&&(n=!1),e){var t=e.toString(),r=[];t.indexOf("year")>-1&&r.push(n?"%y":"%Y"),t.indexOf("month")>-1&&r.push(n?"%b":"%B"),t.indexOf("day")>-1?r.push(n?"%a":"%A"):t.indexOf("date")>-1&&r.push("%d");var i=[];t.indexOf("hours")>-1&&i.push("%H"),t.indexOf("minutes")>-1&&i.push("%M"),t.indexOf("seconds")>-1&&i.push("%S"),t.indexOf("milliseconds")>-1&&i.push("%L");var o=[];return r.length>0&&o.push(r.join("-")),i.length>0&&o.push(i.join(":")),o.length>0?o.join(" "):void 0}}!function(e){e[e.YEAR="year"]="YEAR",e[e.MONTH="month"]="MONTH",e[e.DAY="day"]="DAY",e[e.DATE="date"]="DATE",e[e.HOURS="hours"]="HOURS",e[e.MINUTES="minutes"]="MINUTES",e[e.SECONDS="seconds"]="SECONDS",e[e.MILLISECONDS="milliseconds"]="MILLISECONDS",e[e.YEARMONTH="yearmonth"]="YEARMONTH",e[e.YEARMONTHDAY="yearmonthday"]="YEARMONTHDAY",e[e.YEARMONTHDATE="yearmonthdate"]="YEARMONTHDATE",e[e.YEARDAY="yearday"]="YEARDAY",e[e.YEARDATE="yeardate"]="YEARDATE",e[e.YEARMONTHDAYHOURS="yearmonthdayhours"]="YEARMONTHDAYHOURS",e[e.YEARMONTHDAYHOURSMINUTES="yearmonthdayhoursminutes"]="YEARMONTHDAYHOURSMINUTES",e[e.YEARMONTHDAYHOURSMINUTESSECONDS="yearmonthdayhoursminutesseconds"]="YEARMONTHDAYHOURSMINUTESSECONDS",e[e.HOURSMINUTES="hoursminutes"]="HOURSMINUTES",e[e.HOURSMINUTESSECONDS="hoursminutesseconds"]="HOURSMINUTESSECONDS",e[e.MINUTESSECONDS="minutesseconds"]="MINUTESSECONDS",e[e.SECONDSMILLISECONDS="secondsmilliseconds"]="SECONDSMILLISECONDS"}(t.TimeUnit||(t.TimeUnit={}));var i=t.TimeUnit;t.TIMEUNITS=[i.YEAR,i.MONTH,i.DAY,i.DATE,i.HOURS,i.MINUTES,i.SECONDS,i.MILLISECONDS,i.YEARMONTH,i.YEARMONTHDAY,i.YEARMONTHDATE,i.YEARDAY,i.YEARDATE,i.YEARMONTHDAYHOURS,i.YEARMONTHDAYHOURSMINUTES,i.YEARMONTHDAYHOURSMINUTESSECONDS,i.HOURSMINUTES,i.HOURSMINUTESSECONDS,i.MINUTESSECONDS,i.SECONDSMILLISECONDS],t.format=r},{}],29:[function(e,n,t){arguments[4][23][0].apply(t,arguments)},{dup:23}],30:[function(e,n,t){"use strict";function r(e){return M.isString(e)||M.isNumber(e)||M.isBoolean(e)?String(e):m(e)}function i(e,n){return e.indexOf(n)>-1}function o(e,n){return e.filter(function(e){return!i(n,e)})}function u(e,n){return e.concat(o(n,e))}function a(e,n,t){if(e.forEach)e.forEach.call(t,n);else for(var r in e)e.hasOwnProperty(r)&&n.call(t,e[r],r,e)}function c(e,n,t,r){if(e.reduce)return e.reduce.call(r,n,t);for(var i in e)e.hasOwnProperty(i)&&(t=n.call(r,t,e[i],i,e));return t}function s(e,n,t){if(e.map)return e.map.call(t,n);var r=[];for(var i in e)e.hasOwnProperty(i)&&r.push(n.call(t,e[i],i,e));return r}function f(e,n){for(var t=0,r=0;r<e.length;r++)if(n(e[r],r,t++))return!0;return!1}function l(e,n){for(var t=0,r=0;r<e.length;r++)if(!n(e[r],r,t++))return!1;return!0}function p(e){return[].concat.apply([],e)}function d(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];for(var r=0;r<n.length;r++)e=y(e,n[r]);return e}function y(e,n){if("object"!=typeof n||null===n)return e;for(var t in n)n.hasOwnProperty(t)&&void 0!==n[t]&&("object"!=typeof n[t]||null===n[t]?e[t]=n[t]:"object"!=typeof e[t]||null===e[t]?e[t]=d(n[t].constructor===Array?[]:{},n[t]):d(e[t],n[t]));return e}function h(e,n){return v({min:e.min,max:e.max,maxbins:n})}function E(e,n){var t,r,i,o=[],u={};for(r=0,i=e.length;i>r;++r)t=n?n(e[r]):e[r],t in u||(u[t]=1,o.push(e[r]));return o}function T(e){console.warn("[VL Warning]",e)}function g(e){console.error("[VL Error]",e)}function A(e,n){for(var t in e)if(e.hasOwnProperty(t)&&n[t]&&e[t]&&n[t]!==e[t])return!0;return!1}var m=e("json-stable-stringify"),N=e("datalib/src/util");t.keys=N.keys,t.extend=N.extend,t.duplicate=N.duplicate,t.isArray=N.isArray,t.vals=N.vals,t.truncate=N.truncate,t.toMap=N.toMap,t.isObject=N.isObject,t.isString=N.isString,t.isNumber=N.isNumber,t.isBoolean=N.isBoolean;var S=e("datalib/src/generate");t.range=S.range;var C=e("./encoding");t.has=C.has;var O=e("./channel");t.Channel=O.Channel;var M=e("datalib/src/util");t.hash=r,t.contains=i,t.without=o,t.union=u,t.forEach=a,t.reduce=c,t.map=s,t.any=f,t.all=l,t.flatten=p,t.mergeDeep=d;var v=e("datalib/src/bins/bins");t.getbins=h,t.unique=E,t.warning=T,t.error=g,t.differ=A},{"./channel":25,"./encoding":26,"datalib/src/bins/bins":15,"datalib/src/generate":16,"datalib/src/util":18,"json-stable-stringify":19}]},{},[5])(5)});
//# sourceMappingURL=compassql.min.js.map
